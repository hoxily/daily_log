2019-01-15

App客户端使用微信支付收到成功的PayResp通知后，文档里建议向服务器请求校验是否已真正完成了订单支付。然而微信支付成功的通知是异步通知服务器的。也就是有可能在App收到成功的PayResp回应时，询问服务器会回复订单未支付。那就是蛋疼了。如果UI界面上告知用户支付失败，那么用户就可以重新再次支付，也就造成重复支付了。

否则的话，App收到成功的PayResp时，持续地向服务器查询订单支付状态，UI界面持续处于等待状态。感觉也不合理。

经过搜索，发现有大神提到可以在App收到成功的PayResp时，向服务器查询订单状态。但这时服务器不是被动的等待微信的异步通知。而是主动调用微信提供的查询订单接口来刷新支付状态。这样一来，App界面就不需要阻塞在等待界面了。

----

真是奇怪。我考虑这么多做什么。要简化问题。抓住重点。能应对大部分情况就行。不通的情况，用户自然会小心绕过。
问过李卫，它那边并不会主动使用微信的订单查询接口，而是被动等待微信的异步通知。

简单地说，微信sdk通知成功时，界面跳回我的订单页即可。
