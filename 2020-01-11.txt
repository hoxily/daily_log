2020年01月11日, 星期六, GPS(30.3108, 120.0904)

万园今天在让web端的明线效果与小工具一致的过程中，发现了2个问题。

第一个是小工具上明线看起来亮很多，不管是拉近镜头观察还是离远了观察。但是在web端，只要一拉远观察，就会发现明线明显得变灰变暗。于是她尝试去使用小工具的mipmap生成算法。也就是把原始的大图，生成一级级的mipmap。她原本想尝试使用面料小工具的ImageMagic库，但是在web端这个库非常大，于是想自己根据原理用js实现一遍。晚上我再次回来的时候，她说其实真正的原因在于alpha通道的处理，也就是这篇文章提到的含有透明度的图像缩放处理：https://entropymine.com/imageworsener/resizealpha/ 

第二个问题则是mipmap在threejs上不起作用，显示成怪异的黑白色块的问题。她使用自己写的resize算法，处理那些宽高相等的纹理的时候都正常，但是处理宽高不相等的纹理的时候，就会出现奇怪的大块的黑白色块。最后在网上找到的一个mipmap例子，里面说要求最大level计算到1x1为止。跟宽高是否为PowerOfTwo没有关系。举例来说，就是一个level 0 为256x128的原始图，其接下来的一系列mipmap分别为：128x64, 64x32, 32x16, 16x8, 8x4, 4x2, 2x1, 1x1。注意到不是计算到2x1就停止了，而已一直计算到宽与高都为1为止。当其中一边不足以除以2时，保持为1。
